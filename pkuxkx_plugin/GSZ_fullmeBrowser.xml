<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on 2016年 九月 17日 星期六, 上午 11:07 -->
<!-- MuClient version 5.02 -->

<!-- Plugin "GSZ_fullmebrowser" generated by Plugin Wizard -->

<muclient>
<plugin
   name="GSZ_fullmebrowser"
   author="creat"
   id="4dbc8337be84d76df298b27e"
   language="Lua"
   purpose="querypath进出绝情谷|浏览器打开fullme"
   date_written="2016-09-17 11:05:28"
   requires="4.00"
   version="1.0"
   >
<description trim="y">
<![CDATA[
进出绝情谷时在洞口输入命令 querypath
图片会打开默认浏览器
]]>
</description>

</plugin>


<!--  Get our standard constants -->

<include name="/Users/shanghua/MUSHclient/worlds/plugins/constants.lua"/>

<!--  Triggers  -->

<triggers>
  <trigger
   enabled="y"
   group="All_all"
   keep_evaluating="y"
   match="^请注意，忽略验证码中的红色文字。|http\:\/\/pkuxkx.net\/\w+\/\w+\.\w+\?\w+\=\d+$"
   name="fullme_openbrowser"
   regexp="y"
   script="fullme_openbrowser"
   send_to="12"
   sequence="95"
   variable="fullme_open"
  >
  <send>--</send>
  </trigger>
  <trigger
   enabled="y"
   group="All_all"
   lines_to_match="2"
   keep_evaluating="y"
   match="^(石壁上竟是你之前刻上的路线：|你之前刻上的路线是：)\n(.*)\s$"
   multi_line="y"
   name="jueqinggu_path"
   regexp="y"
   script="jueqingguinandout"
   send_to="12"
   sequence="80"
   variable="jueqinggu_path"
  >
  <send>--</send>
  </trigger>
</triggers>

<!--  Script  -->


<script>
<![CDATA[
--------------绝情谷
function jueqingguinandout (_,l,w)
--"你终于走出了这段黑暗的山洞。"
local fx={["右"]="you",["左"]="zuo",["前"]="qian",["后"]="hou"}
local step=w[2]
local walk
step=utils.split (step," ")
for i,v in pairs (step) do if fx[v] then walk="(move " .. fx[v] .. ")"step[i]=walk end end
walk=table.concat(step,"\n")
local t={["石壁上竟是你之前刻上的路线："]="2(enter)";["你之前刻上的路线是："]="(enter)"}
local tn=w[1]
t=(t[tn])--EvaluateSpeedwalk 
walk=t .. walk
t={["石壁上竟是你之前刻上的路线："]="e5n";["你之前刻上的路线是："]="(out)(se)8e"}
tn=w[1]
t= (t[tn])--EvaluateSpeedwalk
walk=walk .. t
DoAfterSpeedWalk (0.5,walk)
end

--------fullme开浏览器
function fullme_openbrowser(_,l,_,s)
local _,_,line=string.find (s[1].text,"(%l.+)")
if line and url_open 
	then OpenBrowser(line) url_open=nil
elseif l=="请注意，忽略验证码中的红色文字。" and s[1].textcolour==GetBoldColour(2)
	then url_open=true
end
end
]]>
</script>


</muclient>
